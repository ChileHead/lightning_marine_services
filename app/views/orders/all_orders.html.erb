<% content_for :title, "All #{Order.all.count} Orders" %>
<% content_for :subtitle, "#{ Order.unarchived.all.count} Unarchieved Orders" %>
<% content_for :subtitle_two, "#{Order.archived.count} Archieved Orders" %>

<%= render 'shared/tab_table_options' %>
<%= render 'shared/new_modal' %>
<br>
<%= render 'shared/top_table_header', resource: @orders %>


<table class="bg-white table table-striped border border-2">
  <thead>
    <tr>
      <% @initialize_table_options.selected_table_options.each do |option| %>
            <% if ((option[1]) == 'po_number') || ((option[1]) == 'order_content' )%>
                <th>
                  <%= "#{option[0]}"%>
                </th>
            <% else %>
                <th>
                  <%= link_to "#{option[0]}", request.params.merge(sort_option: "#{option[1]}", sort_direction: sort_direction ) %>
                </th>
            <% end %>
      <% end %>

      <!-- <th>
        <%= link_to "Order ID", request.params.merge(sort_option: 'id', sort_direction: sort_direction ) %>
      </th>

      <th>
        <%= link_to "Dept", request.params.merge(sort_option: 'dept', sort_direction: sort_direction ) %>
      </th>

      <th>
        <%= link_to "Ship", request.params.merge(sort_option: 'ship_name', sort_direction: sort_direction ) %>
      </th>

      <th>
        <%= link_to "Vendor", request.params.merge(sort_option: 'vendor_name', sort_direction: sort_direction ) %>
      </th>

      <th>
        PO #
      </th>

      <th>
        <%= link_to "Date Recieved", request.params.merge(sort_option: 'date_recieved', sort_direction: sort_direction ) %>
      </th>

      <th>
        Order Content
      </th>

      <th>
        <%= link_to "Courrier", request.params.merge(sort_option: 'courrier', sort_direction: sort_direction ) %>
      </th>

      <th>
        <%= link_to "Date Delivered", request.params.merge(sort_option: 'date_delivered', sort_direction: sort_direction ) %>
      </th> -->


    </tr>
  </thead>

  <tbody id="table-body">
    <% @orders.paginate.each do |order| %>
      <tr>

        <% @initialize_table_options.selected_table_options.each do |option| %>
            <td>

              <% if (option[1]) == 'id' %>

                <% if (option[1]) == 'id' && ( order.archived? == true ) %>
                  <span class="text-gray-500">archived</span>
                  <br>
                <% end %>
                <%= link_to "#{order.id}", order_path(order) %>

              <% elsif (option[1]) == 'ship_name' %>
                <%= link_to "#{order.purchaser.name}", purchaser_path(order.purchaser) %>

              <% elsif (option[1]) == 'vendor_name' %>
                <%= link_to "#{order.vendor.name}", vendor_path(order.vendor) %>

              <% elsif (option[1]) == 'date_recieved' %>
                <%= order.date_recieved ? order.date_recieved.try(:strftime,"%m/%d/%Y") : 'n/a' %>

              <% elsif (option[1]) == 'order_content' %>

                  <% if order.order_content.present? %>

                    <%= link_to(order_path(order)) do %>

                      Boxes: <%= order.order_content.box ||= "n/a" %>
                      <br>
                      Crates: <%= order.order_content.crate ||= "n/a" %>
                      <br>
                      Pallets: <%= order.order_content.pallet ||= "n/a" %>
                      <br>

                      <% if is_nil_and_zero(order.order_content.other) == false %>
                         <%= "Other: #{order.order_content.other}" %>
                         <br>
                         <%= order.order_content.other_description.to_s.chars.count >= 75 ? "Description: #{order.order_content.other_description[0..75]...}" : "Description: #{order.order_content.other_description}" if order.order_content.other_description %>
                      <% end %>

                    <% end %>
                  <% end %>

              <% elsif (option[1]) == 'date_delivered' %>
                <%= order.date_delivered ? order.date_delivered.try(:strftime,"%m/%d/%Y") : 'n/a' %>

              <% else %>
                <%= order.send(option[1]) %>
              <% end %>

            </td>
        <% end %>


          <!-- <td class="align-middle font-light" id="id">
            <% if order.archived? == true %>
              <div class="text-gray-500">
                archived
              </div>
            <% end %>

            <span class="font-light">
              <%= order.id %>
            </span>
          </td>

          <td class="align-middle font-light" id="dept">
              <%= order.dept ||= "n/a" %>
          </td>

          <td class="align-middle font-light" id="">
            <%= link_to "#{order.purchaser.name}", purchaser_path(order.purchaser) %>
          </td>

          <td class="align-middle font-light" id="">
            <%= link_to "#{order.vendor.name}", vendor_path(order.vendor) %>
          </td>

          <td class="align-middle font-light" id="">
            <%= order.po_number ||= "n/a" %>
          </td>

          <td class="align-middle font-light" id="">
            <%=  order.date_recieved ? order.date_recieved.try(:strftime,"%m/%d/%Y") : 'n/a' %>
          </td>

          <td class="align-middle font-light" id="">
            <% if order.order_content.present? %>

              <%= link_to(order_path(order)) do %>

                Boxes: <%= order.order_content.box ||= "n/a" %>
                <br>
                Crates: <%= order.order_content.crate ||= "n/a" %>
                <br>
                Pallets: <%= order.order_content.pallet ||= "n/a" %>
                <br>

                <% if is_nil_and_zero(order.order_content.other) == false %>
                   <%= "Other: #{order.order_content.other}" %>
                   <br>
                   <%= order.order_content.other_description.to_s.chars.count >= 75 ? "Description: #{order.order_content.other_description[0..75]...}" : "Description: #{order.order_content.other_description}" if order.order_content.other_description %>
                <% end %>

              <% end %>
            <% end %>
          </td>

          <td class="align-middle font-light" id="">
            <%= order.courrier %>
          </td>

          <td class="align-middle font-light" id="">
            <%=  order.date_delivered ? order.date_delivered.try(:strftime,"%m/%d/%Y") : 'n/a' %>
          </td> -->

      </tr>

    <% end %>

  </tbody>
</table>


<%= render "shared/pagination/pagination_buttons", total_pages: @orders.total_pages %>
