<% content_for :title, "#{Order.all.count} Orders" %>

<%= render 'shared/tab_table_options' %>
<%= render 'shared/new_modal' %>

<table class="bg-white table table-striped border border-2">
  <thead>
    <tr>
      <th>
        <%= link_to "Order ID", request.params.merge(sort_option: 'id', sort_direction: sort_direction ) %>
      </th>

      <th>
        <%= link_to "Ship", request.params.merge(sort_option: 'purchaser_name', sort_direction: sort_direction ) %>
      </th>

      <th>
        <%= link_to "Vendor", request.params.merge(sort_option: 'vendor_name', sort_direction: sort_direction ) %>
      </th>

      <th>
        PO #
      </th>

      <th>
        <%= link_to "Date Recieved", request.params.merge(sort_option: 'date_recieved', sort_direction: sort_direction ) %>
      </th>

      <th>
        Order Content
      </th>

      <th>
        <%= link_to "Courrier", request.params.merge(sort_option: 'courrier', sort_direction: sort_direction ) %>
      </th>
    </tr>
  </thead>
  <tbody>

    <% @orders.each do |order| %>
      <tr>
          <td class=" align-middle font-light">
            <%= order.id %>
          </td>

          <td class=" align-middle font-light">
            <%= link_to "#{order.purchaser.name}", purchaser_path(order.purchaser) %>
          </td>

          <td class=" align-middle font-light">
            <%= link_to "#{order.vendor.name}", vendor_path(order.vendor) %>
          </td>

          <td class=" align-middle font-light">
            <%= order.po_number ||= "n/a" %>
          </td>

          <td class=" align-middle font-light">
            <%=  order.date_recieved ? order.date_recieved.try(:strftime,"%m/%d/%Y") : 'n/a' %>
          </td>

          <td class=" align-middle font-light">
            <% if order.order_content.present? %>

              <%= link_to(order_path(order)) do %>

                Boxes: <%= order.order_content.box ||= "n/a" %>
                <br>
                Crates: <%= order.order_content.crate ||= "n/a" %>
                <br>
                Pallets: <%= order.order_content.pallet ||= "n/a" %>
                <br>

                <% if is_nil_and_zero(order.order_content.other) == false %>
                   <%= "Other: #{order.order_content.other}" %>
                   <br>
                   <%= order.order_content.other_description.to_s.chars.count >= 75 ? "Description: #{order.order_content.other_description[0..75]...}" : "Description: #{order.order_content.other_description}" if order.order_content.other_description %>
                <% end %>

              <% end %>
            <% end %>
          </td>

          <td class=" align-middle font-light">
            <%= order.courrier %>
          </td>
      </tr>
    <% end %>

  </tbody>
</table>


  <!-- <div>
    <div>
      <%#= render "shared/pagination_buttons" %>
    </div>
  </div> -->


  <div class="p-4">
    <%= link_to "Prev", request.params.merge(page: @page - 1) unless @page < 1 %>
    |
    <%= link_to "Next", request.params.merge(page: @page + 1) %>
  </div>
